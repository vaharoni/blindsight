var controller = function() {
  this.trigger = '#nt-shape-comparison';

  this.name = 'NT shape comparison';

  // Ruby:
  //  (%w(R T).product([1, 2]).product(%w(R T).product([-1, -2])) * 8).shuffle
  this.params = [[["R", 1], ["R", -2]], [["R", 1], ["T", -2]], [["R", 2], ["R", -1]], [["T", 2], ["R", -1]],
    [["R", 2], ["R", -1]], [["T", 2], ["T", -1]], [["T", 2], ["T", -1]], [["R", 2], ["R", -1]], [["T", 2], ["R", -1]],
    [["R", 2], ["T", -1]], [["R", 2], ["R", -1]], [["R", 1], ["T", -1]], [["R", 1], ["R", -1]], [["R", 1], ["R", -2]],
    [["T", 1], ["T", -1]], [["T", 1], ["R", -1]], [["R", 1], ["R", -2]], [["T", 1], ["T", -1]], [["T", 2], ["T", -1]],
    [["R", 1], ["T", -1]], [["T", 1], ["R", -2]], [["T", 1], ["R", -2]], [["R", 2], ["T", -1]], [["R", 1], ["R", -1]],
    [["R", 2], ["R", -2]], [["R", 1], ["R", -1]], [["T", 1], ["R", -2]], [["T", 1], ["R", -1]], [["R", 1], ["T", -2]],
    [["T", 1], ["R", -2]], [["R", 1], ["T", -2]], [["T", 1], ["R", -2]], [["T", 1], ["T", -2]], [["T", 2], ["T", -2]],
    [["T", 1], ["R", -1]], [["R", 1], ["T", -1]], [["T", 2], ["R", -1]], [["T", 2], ["T", -2]], [["R", 1], ["T", -2]],
    [["T", 1], ["R", -2]], [["T", 2], ["T", -1]], [["R", 1], ["R", -1]], [["R", 1], ["T", -1]], [["T", 2], ["T", -2]],
    [["T", 2], ["R", -2]], [["R", 1], ["R", -2]], [["T", 1], ["T", -1]], [["R", 1], ["T", -2]], [["T", 2], ["R", -2]],
    [["R", 2], ["T", -2]], [["T", 2], ["T", -1]], [["R", 2], ["T", -1]], [["R", 1], ["T", -1]], [["R", 2], ["R", -2]],
    [["R", 2], ["R", -2]], [["R", 2], ["T", -2]], [["R", 1], ["T", -1]], [["T", 1], ["R", -2]], [["T", 1], ["T", -2]],
    [["T", 2], ["R", -2]], [["R", 2], ["R", -1]], [["T", 2], ["R", -1]], [["R", 1], ["R", -1]], [["R", 2], ["R", -2]],
    [["R", 2], ["R", -2]], [["R", 1], ["R", -1]], [["R", 2], ["T", -1]], [["T", 2], ["T", -1]], [["T", 2], ["R", -2]],
    [["R", 2], ["R", -2]], [["T", 2], ["R", -2]], [["T", 2], ["T", -2]], [["T", 1], ["R", -1]], [["T", 2], ["T", -2]],
    [["T", 1], ["T", -2]], [["R", 1], ["R", -2]], [["T", 1], ["T", -1]], [["R", 1], ["R", -2]], [["T", 2], ["R", -2]],
    [["T", 2], ["R", -1]], [["T", 1], ["R", -1]], [["R", 1], ["R", -1]], [["T", 1], ["T", -2]], [["T", 1], ["T", -1]],
    [["R", 2], ["T", -1]], [["T", 1], ["T", -2]], [["T", 2], ["R", -1]], [["T", 1], ["R", -1]], [["T", 2], ["T", -2]],
    [["R", 2], ["T", -2]], [["T", 1], ["R", -2]], [["T", 2], ["R", -2]], [["R", 2], ["T", -2]], [["R", 1], ["R", -2]],
    [["R", 2], ["T", -2]], [["T", 1], ["T", -2]], [["R", 2], ["R", -1]], [["T", 2], ["T", -2]], [["R", 2], ["T", -2]],
    [["R", 2], ["R", -2]], [["R", 1], ["T", -2]], [["T", 1], ["R", -1]], [["T", 2], ["T", -1]], [["R", 2], ["T", -2]],
    [["R", 1], ["R", -1]], [["R", 1], ["T", -2]], [["R", 2], ["R", -2]], [["R", 2], ["T", -1]], [["R", 1], ["R", -2]],
    [["R", 2], ["R", -1]], [["R", 1], ["T", -1]], [["R", 2], ["T", -2]], [["T", 2], ["R", -1]], [["T", 1], ["T", -2]],
    [["T", 1], ["T", -2]], [["T", 1], ["T", -1]], [["T", 1], ["T", -1]], [["T", 2], ["T", -1]], [["R", 2], ["R", -1]],
    [["R", 2], ["T", -1]], [["R", 1], ["T", -2]], [["R", 1], ["T", -1]], [["R", 2], ["T", -1]], [["T", 2], ["R", -1]],
    [["T", 2], ["T", -2]], [["T", 1], ["T", -1]], [["T", 2], ["R", -2]], [["T", 1], ["R", -1]]],

  this.run = async function(params) {
    var FixationDot = new app.shapes.dotClass(app.grids.horizontal, 6.5, 'yellow');
    var fixationDot = FixationDot.new(0,0);
    fixationDot.show();

    var Triangle = new app.shapes.triangleClass(app.grids.horizontal, 1, 3, 'white');
    var Rectangle = new app.shapes.rectangleClass(app.grids.horizontal, 1, 3, 'white');

    var drawShape = function(arr) {
      var shape = arr[0] == "R" ? Rectangle.new(arr[1], 1) : Triangle.new(arr[1], 1);
      shape.show();
      return shape;
    }

    await app.sleep(2000);

    for (i = 0; this.work && i < params.length; i++) {
      var right = drawShape(params[i][0]);
      var left = drawShape(params[i][1]);
      await app.sleep(500);
      right.hide();
      left.hide();
      await app.sleep(3500);
    }
  }
}
app.controllers.nt.shapeComparison = app.buildTrialController(controller);
